<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spring注解驱动开发【源码】——AOP原理——AnnotationAwareAspectJAutoProxyCreator | Java</title>
    <meta name="description" content="A VitePress Site">
    <meta name="generator" content="VitePress v1.3.0">
    <link rel="preload stylesheet" href="/java/assets/style.hc7XPR8-.css" as="style">
    
    <script type="module" src="/java/assets/app.Cg3VBmf4.js"></script>
    <link rel="preload" href="/java/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/java/assets/chunks/framework.BAO6c_AF.js">
    <link rel="modulepreload" href="/java/assets/chunks/theme.iI1afelZ.js">
    <link rel="modulepreload" href="/java/assets/spring_annotation_11-AnnotationAwareAspectJAutoProxyCreator.md.DzTDHRpO.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar has-sidebar top" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-0ad69264><a class="title" href="/java/" data-v-0ad69264><!--[--><!--]--><!----><span data-v-0ad69264>Java</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>Java基础</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/basic/collection/CollectionInterviewQuestions.html" data-v-f51f088d><!--[-->JavaSE<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/jvm/01-ByteCode.html" data-v-f51f088d><!--[-->JVM<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>计算机基础</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/algorithm/001-GettingStart.html" data-v-f51f088d><!--[-->数据结构与算法<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/design-patterns/01-dp/01-introduction-to-design-patterns.html" data-v-f51f088d><!--[-->设计模式<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>数据库</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/mysql/MySQLInterviewQuestions.html" data-v-f51f088d><!--[-->MySQL<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/redis/RedisInterviewQuestions.html" data-v-f51f088d><!--[-->Redis<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>Spring</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/spring/annotation/01-ComponentRegist.html" data-v-f51f088d><!--[-->Spring注解驱动开发<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>中间件</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/rabbitmq/01-GettingStart.html" data-v-f51f088d><!--[-->RabbitMQ<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>并发编程</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/juc/JUCInterviewQuestions.html" data-v-f51f088d><!--[-->JUC<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>项目实战</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-f51f088d><a class="VPLink link" href="/java/projects/tingshu/01-GettingStart.html" data-v-f51f088d><!--[-->听书项目(仿喜马拉雅)<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/pengbin2367/java" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-af5898d3><span class="vpi-more-horizontal icon" data-v-af5898d3></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/pengbin2367/java" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-883964e0><button data-v-883964e0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>注解开发</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/01-ComponentRegist.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>组件注册</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/02-BeanLifeCycle.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Bean生命周期</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/03-PropertyAndAutowiring.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>属性赋值&自动装配</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/04-AOP.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>AOP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/05-MultiEnvConfig.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>多环境配置</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>AOP源码分析</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/10-@EnableAspectJAutoProxy.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>@EnableAspectJAutoProxy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/11-AnnotationAwareAspectJAutoProxyCreator.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>AnnotationAwareAspectJAutoProxyCreator</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/12-CreatAOP.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>创建AOP代理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/13-GetInterceptChain.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>获取拦截器链</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/14-ChainingNotificationMethods.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>链式调用通知方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/15-SummaryOfAOP.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>AOP原理总结</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>扩展原理</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/20-@EnableTransactionManagement.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>声明式事务</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/21-BeanFactoryPostProcessor.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>BeanFactoryPostProcessor</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/22-BeanDefinitionRegistryPostProcessor.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>BeanDefinitionRegistryPostProcessor</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/23-ApplicationListener.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>ApplicationListener用法&原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/java/spring/annotation/24-@EventListenerAndSmartInitializingSingleton.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>@EventListener&SmartInitializingSingleton</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _java_spring_annotation_11-AnnotationAwareAspectJAutoProxyCreator" data-v-e6f2a212><div><h2 id="分析" tabindex="-1">分析 <a class="header-anchor" href="#分析" aria-label="Permalink to &quot;分析&quot;">​</a></h2><p>通过前面我们知道：@EnableAspectJAutoProxy注解就是为了给容器中注册一个AnnotationAwareAspectJAutoProxyCreator，我们先来看一下它的继承树：</p><p><img src="/java/assets/image-20220206200649652.BzkEB-60.png" alt="image-20220206200649652"></p><p>通过这个继承树以及源码中我们可以看到，在AbstractAutoProxyCreator中，实现了SmartInstantiationAwareBeanPostProcessor和BeanFactoryAware两个接口。而我们知道：xxxAwareBeanPostProcessor是后置处理器（也就是bean初始化前后做的事），BeanFactoryAware用于自动装配。</p><p><img src="/java/assets/image-20220206200934054.Baui_Zac.png" alt="image-20220206200934054"></p><p>我们一层一层去看都有哪些需要我们去关注的方法。在AbstractAutoProxyCreator中，我们重点是这些postProcess方法，可以为这些有实现的方法打上断点：</p><p><img src="/java/assets/image-20220206201438182.CKt_O7Pu.png" alt="image-20220206201438182"></p><p>在AbstractAdvisorAutoProxyCreator中，有一个setBeanFactory方法毫无疑问是用来自动装配的，我们可以打上断点：</p><p><img src="/java/assets/image-20220206201600858.DeN3SJbe.png" alt="image-20220206201600858"></p><p>AspectJAwareAdvisorAutoProxyCreator中并没有跟后置处理器和自动装配有关的方法，可以跳过。</p><p>在AnnotationAwareAspectJAutoProxyCreator中有一个initBeanFactory是用来初始化BeanFactory的，我们也可以给它打上断点：</p><p><img src="/java/assets/image-20220206201801692.VssWwtT5.png" alt="image-20220206201801692"></p><p>最后，我们给配置类中注册两个bean打上断点：</p><p><img src="/java/assets/image-20220206202841315.CBdAQDgc.png" alt="image-20220206202841315"></p><h2 id="注册-annotationawareaspectjautoproxycreator" tabindex="-1">注册 AnnotationAwareAspectJAutoProxyCreator <a class="header-anchor" href="#注册-annotationawareaspectjautoproxycreator" aria-label="Permalink to &quot;注册 AnnotationAwareAspectJAutoProxyCreator&quot;">​</a></h2><p>Debug运行，来到第一个断点处，是我们的AbstractAdvisorAutoProxyCreator中的setBeanFactory方法：</p><p><img src="/java/assets/image-20220206203126272.B87DDwzB.png" alt="image-20220206203126272"></p><p>我们从我们的test方法开始，看看经历了哪些流程！</p><p>首先是传入配置类，创建IOC容器：</p><p><img src="/java/assets/image-20220206203256817.DjjB_FR-.png" alt="image-20220206203256817"></p><p>然后是注册配置类，调用refresh()方法刷新容器：</p><p><img src="/java/assets/image-20220206203404286.BOUx4xDP.png" alt="image-20220206203404286"></p><p>在refresh中，来到第528行的registerBeanPostProcessors(beanFactory); 在这里面注册bean的后置处理器以方便拦截bean的创建：</p><p><img src="/java/assets/image-20220206203648006.RFBKRi3W.png" alt="image-20220206203648006"></p><p>我们进入registerBeanPostProcessors方法看看：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> registerBeanPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    	ConfigurableListableBeanFactory beanFactory, AbstractApplicationContext applicationContext) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		// ① 先获取IOC容器中已经定义了的需要创建对象的所有BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] postProcessorNames </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBeanNamesForType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(BeanPostProcessor.class, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ② 给容器中加别的BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Register BeanPostProcessorChecker that logs an info message when</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // a bean is created during BeanPostProcessor instantiation, i.e. when</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // a bean is not eligible for getting processed by all BeanPostProcessors.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanProcessorTargetCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBeanPostProcessorCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> postProcessorNames.length;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addBeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BeanPostProcessorChecker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanFactory, beanProcessorTargetCount));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Separate between BeanPostProcessors that implement PriorityOrdered,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Ordered, and the rest.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; priorityOrderedPostProcessors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; internalPostProcessors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; orderedPostProcessorNames </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; nonOrderedPostProcessorNames </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (String ppName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> postProcessorNames) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isTypeMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName, PriorityOrdered.class)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            BeanPostProcessor pp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName, BeanPostProcessor.class);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            priorityOrderedPostProcessors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pp);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (pp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MergedBeanDefinitionPostProcessor) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                internalPostProcessors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pp);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isTypeMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName, Ordered.class)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            orderedPostProcessorNames.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ⑤ 注册没实现优先级接口的BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            nonOrderedPostProcessorNames.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ③ 优先注册实现了PriorityOrdered接口的BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // First, register the BeanPostProcessors that implement PriorityOrdered.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sortPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(priorityOrderedPostProcessors, beanFactory);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    registerBeanPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanFactory, priorityOrderedPostProcessors);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ④ 再给容器中注册实现了Ordered接口的BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Next, register the BeanPostProcessors that implement Ordered.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; orderedPostProcessors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (String ppName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orderedPostProcessorNames) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        BeanPostProcessor pp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName, BeanPostProcessor.class);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        orderedPostProcessors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pp);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (pp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MergedBeanDefinitionPostProcessor) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            internalPostProcessors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pp);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sortPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(orderedPostProcessors, beanFactory);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    registerBeanPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanFactory, orderedPostProcessors);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ⑤ 注册没实现优先级接口的BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Now, register all regular BeanPostProcessors.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; nonOrderedPostProcessors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (String ppName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nonOrderedPostProcessorNames) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        BeanPostProcessor pp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ppName, BeanPostProcessor.class);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        nonOrderedPostProcessors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pp);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (pp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MergedBeanDefinitionPostProcessor) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            internalPostProcessors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pp);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    registerBeanPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanFactory, nonOrderedPostProcessors);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Finally, re-register all internal BeanPostProcessors.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sortPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(internalPostProcessors, beanFactory);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    registerBeanPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanFactory, internalPostProcessors);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Re-register post-processor for detecting inner beans as ApplicationListeners,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // moving it to the end of the processor chain (for picking up proxies etc).</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    beanFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addBeanPostProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ApplicationListenerDetector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(applicationContext));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>而我们的AnnotationAwareAspectJAutoProxyCreator通过前面的继承树可以看到，它是实现了Ordered接口的，因此它会走Next注册：</p><p><img src="/java/assets/image-20220206205140594.B8bbQsri.png" alt="image-20220206205140594"></p><blockquote><p>ps：注册BeanPostProcessor，实际上就是创建BeanPostProcessor对象，保存在容器中。也就是创建internalAutoProxyCreator的BeanPostProcessor【AnnotationAwareAspectJAutoProxyCreator】。之前是将AnnotationAwareAspectJAutoProxyCreator的定义信息赋给了internalAutoProxyCreator，现在就通过internalAutoProxyCreator中的BeanDefinition来创建AnnotationAwareAspectJAutoProxyCreator。</p></blockquote><p>现在我们来到了红色框中的部分准备获取bean，而我们的bean还没有创建好，因此要先去创建bean，因此来到白色框部分：</p><p><img src="/java/assets/image-20220206205814466.B53oRelP.png" alt="image-20220206205814466"></p><p>在doCreateBean中，首先会创建bean的实例：</p><p><img src="/java/assets/image-20220206205917271.Cn3CryMm.png" alt="image-20220206205917271"></p><p>在给bean初始化之前，还有一步populateBean()来给bean的各种属性赋值：</p><p><img src="/java/assets/image-20220206210226933.CzEULZxd.png" alt="image-20220206210226933"></p><p>赋好值后再通过initializeBean()初始化bean。</p><p>现在来到initializeBean中：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">protected</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">initializeBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String beanName, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object bean, RootBeanDefinition mbd) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSecurityManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        AccessController.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doPrivileged</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PrivilegedAction&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                invokeAwareMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanName, bean);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getAccessControlContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ①处理Aware接口的方法回调</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        invokeAwareMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanName, bean);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Object wrappedBean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bean;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (mbd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mbd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isSynthetic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ②应用后置处理器的postProcessorBeforeInitialization</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        wrappedBean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyBeanPostProcessorsBeforeInitialization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(wrappedBean, beanName);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ③执行自定义的初始化方法</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        invokeInitMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanName, wrappedBean, mbd);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Throwable </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BeanCreationException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            (mbd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mbd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getResourceDescription</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            beanName, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Invocation of init method failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ex);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (mbd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mbd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isSynthetic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ④执行后置处理器的postProcessorsAfterInitialization</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        wrappedBean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyBeanPostProcessorsAfterInitialization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(wrappedBean, beanName);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wrappedBean;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>经过这一系列操作之后，我们的BeanPostProcessor【AnnotationAwareAspectJAutoProxyCreator】就创建成功了！</p><p>创建好之后，会将BeanPostProcessor注册到BeanFactory中：</p><p><img src="/java/assets/image-20220206210748210.pWhh5mfX.png" alt="image-20220206210748210"></p><p>最后来到了我们分析的AbstractAdvisorAutoProxyCreator中setBeanFactory方法。</p><blockquote><p>创建和注册AnnotationAwareAspectJAutoProxyCreator的过程总结：</p><ul><li><pre><code> 1、 传入配置类，创建IOC容器
</code></pre></li><li><pre><code> 2、 注册配置类，调用refresh()刷新容器
</code></pre></li><li><pre><code> 3、 registerBeanPostProcessors(beanFactory); 注册bean的后置处理器来方便拦截bean的创建
  *          ① 先获取IOC容器中已经定义了的需要创建对象的所有BeanPostProcessor
  *          ② 给容器中加别的BeanPostProcessor
  *          ③ 优先注册实现了PriorityOrdered接口的BeanPostProcessor
  *          ④ 再给容器中注册实现了Ordered接口的BeanPostProcessor
  *          ⑤ 注册没实现优先级接口的BeanPostProcessor
  *      ⑥ 注册BeanPostProcessor，实际上就是创建BeanPostProcessor对象，保存在容器中
          *              创建internalAutoProxyCreator的BeanPostProcessor【AnnotationAwareAspectJAutoProxyCreator】
          *              1、创建bean的实例
          *              2、populateBean 给bean的各种属性赋值
          *      3、initializeBean 初始化bean
                  *                  ① invokeAwareMethods() 处理Aware接口的方法回调
                  *                  ② applyBeanPostProcessorsBeforeInitialization() 应用后置处理器的postProcessorBeforeInitialization
                  *                  ③ invokeInitMethods 执行自定义的初始化方法
                  *                  ④ applyBeanPostProcessorsAfterInitialization 执行后置处理器的postProcessorsAfterInitialization
</code></pre></li><li><pre><code> 4、BeanPostProcessor【AnnotationAwareAspectJAutoProxyCreator】创建成功
  *          ⑦ 把BeanPostProcessor注册到BeanFactory中
  *              beanFactory.addBeanPostProcessor(postProcessor);
</code></pre></li></ul></blockquote><h2 id="annotationawareaspectjautoproxycreator-执行时机" tabindex="-1">AnnotationAwareAspectJAutoProxyCreator 执行时机 <a class="header-anchor" href="#annotationawareaspectjautoproxycreator-执行时机" aria-label="Permalink to &quot;AnnotationAwareAspectJAutoProxyCreator 执行时机&quot;">​</a></h2><p>通过前面的介绍，我们知道了创建和注册AnnotationAwareAspectJAutoProxyCreator的过程。下面来看一下AnnotationAwareAspectJAutoProxyCreator作为后置处理器做了什么。</p><p>我们一路放行到下一个断点，来到postProcessBeforeInstantiation断点处：</p><p><img src="/java/assets/image-20220206212204071.BEYSnTNP.png" alt="image-20220206212204071"></p><blockquote><p>ps：需要注意的是，这里是Instantiation，并不是BeanPostProcessor中的postProcessBeforeInitialization。通过继承树也可以看到，SmartInstantiationAwareBeanPostProcessor实现的是InstantiationAwareBeanPostProcessor。</p></blockquote><p><img src="/java/assets/image-20220207185038044.XZ4i9jgY.png" alt="image-20220207185038044"></p><p>在finishBeanFactoryInitialization中，会完成BeanFactory初始化工作，并创建剩下的单实例bean。</p><p>首先，会遍历获取容器中所有的bean，依次创建对象getBean(beanName)：</p><p><img src="/java/assets/image-20220207190004959.DrPwuPsJ.png" alt="image-20220207190004959"></p><p>在getBean中，按照“getBean-&gt;doGetBean-&gt;getSingleton”先尝试获取单实例bean，获取失败，就会去创建bean。</p><blockquote><p>ps：要注意的是，我们之前创建好的AnnotationAwareAspectJAutoProxyCreator会在所有bean创建之前有一个拦截，InstantiationAwareBeanPostProcessor，会调用postProcessBeforeInstantiation：</p><p><img src="/java/assets/image-20220207190520050.B2SkBNqy.png" alt="image-20220207190520050"></p></blockquote><p>在创建bean的时候，会先从缓存中获取当前bean，如果能获取到，说明bean是之前被创建过的，直接使用；否则再创建（只要创建好的bean都会被缓存起来）。</p><p><img src="/java/assets/image-20220207192026939.BgqYPirW.png" alt="image-20220207192026939"></p><p>然后才会来到我们的createBean方法创建bean：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">protected</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String beanName, RootBeanDefinition mbd, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] args) throws BeanCreationException {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDebugEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Creating instance of bean &#39;&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   RootBeanDefinition mbdToUse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mbd;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // Make sure bean class is actually resolved at this point, and</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // clone the bean definition in case of a dynamically resolved Class</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // which cannot be stored in the shared merged bean definition.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Class&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; resolvedClass </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resolveBeanClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mbd, beanName);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (resolvedClass </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mbd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasBeanClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mbd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBeanClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      mbdToUse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RootBeanDefinition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mbd);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      mbdToUse.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setBeanClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(resolvedClass);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // Prepare method overrides.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      mbdToUse.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareMethodOverrides</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (BeanDefinitionValidationException </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BeanDefinitionStoreException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mbdToUse.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getResourceDescription</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            beanName, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Validation of method overrides failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ex);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // Give BeanPostProcessors a chance to return a proxy instead of the target bean instance.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      Object bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resolveBeforeInstantiation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanName, mbdToUse);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bean;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Throwable </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BeanCreationException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mbdToUse.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getResourceDescription</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), beanName,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;BeanPostProcessor before instantiation of bean failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ex);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Object beanInstance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> doCreateBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanName, mbdToUse, args);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDebugEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Finished creating instance of bean &#39;&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beanInstance;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>在createBean中，我们重点关注两个地方：</p><ul><li>resolveBeforeInstantiation(beanName, mbdToUse);</li><li>doCreateBean(beanName, mbdToUse, args);</li></ul><p>resolveBeforeInstantiation就是解析BeforeInstantiation的，通过它上面的注释可以知道“它希望后置处理器在此能返回一个代理对象”，如果能返回一个代理对象就用；如果不能就继续。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">protected</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolveBeforeInstantiation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String beanName, RootBeanDefinition mbd) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Object bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 后置处理器先尝试返回对象</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Boolean.FALSE.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mbd.beforeInstantiationResolved)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Make sure bean class is actually resolved at this point.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mbd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isSynthetic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hasInstantiationAwareBeanPostProcessors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Class&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; targetType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> determineTargetType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(beanName, mbd);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (targetType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 拿到所有后置处理器，如果是InstantiationAwareBeanPostProcessor，就执行postProcessBeforeInstantiation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyBeanPostProcessorsBeforeInstantiation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(targetType, beanName);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyBeanPostProcessorsAfterInitialization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bean, beanName);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mbd.beforeInstantiationResolved </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bean;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>而doCreateBean我们在上面已经进入过了，流程就和上面总结的“注册BeanPostProcessor，实际上就是创建BeanPostProcessor对象，保存在容器中”这一步一样了。</p><blockquote><p>这一段流程总结下来就是：</p><ul><li><p>4、finishBeanFactoryInitialization(beanFactory); 完成BeanFactory初始化工作，创建剩下的单实例bean</p><ul><li><p>Ⅰ 遍历获取容器中所有的Bean，依次创建对象getBean(beanName)</p><ul><li>getBean-&gt;doGetBean-&gt;getSingleton</li></ul></li><li><p>Ⅱ 创建bean</p><p>【AnnotationAwareAspectJAutoProxyCreator再所有bean创建之前会有一个拦截，InstantiationAwareBeanPostProcessor，会调用postProcessBeforeInstantiation】</p></li><li><p>① 先从缓存中获取当前bean，如果能获取到，说明bean是之前被创建过的，直接使用；否则再创建。</p><ul><li>只要创建好的bean都会被缓存起来</li></ul></li><li><p>② createBean(); 创建bean AnnotationAwareAspectJAutoProxyCreator会在任何bean创建之前先尝试返回bean实例</p><ul><li>【BeanPostProcessor是在Bean对象创建完成初始化前后调用的】</li><li>【InstantiationAwareBeanPostProcessor是在创建Bean实例之前先尝试用后置处理器返回对象的】</li><li>1、resolveBeforeInstantiation(beanName, mbdToUse); 解析BeforeInstantiation <ul><li>希望后置处理器在此能返回一个代理对象，如果能返回代理对象就是用；如果不能就继续</li><li>Ⅰ后置处理器先尝试返回对象</li><li>bean = applyBeanPostProcessorsBeforeInstantiation(targetType, beanName);</li><li>拿到所有后置处理器，如果是InstantiationAwareBeanPostProcessor</li><li>就执行postProcessBeforeInstantiation</li><li>if (bean != null) {</li><li>bean = applyBeanPostProcessorsAfterInitialization(bean, beanName);</li><li>}</li></ul></li><li>2、doCreateBean(beanName, mbdToUse, args); 真正的去创建一个bean实例，和3.6流程一样</li></ul></li></ul></li></ul></blockquote></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><div class="edit-info" data-v-1bcd8184><!----><div class="last-updated" data-v-1bcd8184><p class="VPLastUpdated" data-v-1bcd8184 data-v-1bb0c8a8>Last updated: <time datetime="2024-10-25T15:30:03.000Z" data-v-1bb0c8a8></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/java/spring/annotation/10-@EnableAspectJAutoProxy.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>@EnableAspectJAutoProxy</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/java/spring/annotation/12-CreatAOP.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>创建AOP代理</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"algorithm_000-algorithmtemplates.md\":\"Dhxo-PEr\",\"algorithm_000-questionslink.md\":\"DqQHlRo_\",\"algorithm_001-gettingstart.md\":\"C4hvnhXG\",\"algorithm_002-fromsocialexperimenttoentryreminder.md\":\"DKvDTabw\",\"algorithm_003-binaryandbitwiseoperations.md\":\"tmXls5WB\",\"algorithm_004-selectionbubbleinsertionsort.md\":\"BwEBEf5s\",\"algorithm_005-logarithm.md\":\"Bd4vNVL1\",\"algorithm_006-binarysearch.md\":\"D4JZiTao\",\"algorithm_007-timeandspacecomplexity.md\":\"jwfW0EUy\",\"algorithm_008-introductiontoalgorithmsanddatastructures.md\":\"CE1qGpYl\",\"algorithm_009-singlylinkedlistreversalandstackexplained.md\":\"C7MlIhHL\",\"algorithm_010-mergetwolists.md\":\"D609dZjG\",\"algorithm_011-addtwonumbers.md\":\"CwLyJUxC\",\"algorithm_012-partitionlist.md\":\"BrpX3xWU\",\"algorithm_013-queuestackandcircularqueue.md\":\"Cef6-9-q\",\"algorithm_014-convertqueueandstack.md\":\"BCIjtDTq\",\"algorithm_015-getminstack.md\":\"-5bstofU\",\"algorithm_016-circulardeque.md\":\"DT7zciDK\",\"algorithm_017-binarytreetraversalrecursion.md\":\"B7qTBV2G\",\"algorithm_018-binarytreetraversaliteration.md\":\"DH6MMBrj\",\"algorithm_019-processinginputandoutputinalgorithm.md\":\"CWvThdO9\",\"algorithm_020-recursionandthemasterformula.md\":\"Dw_-UwbW\",\"algorithm_021-mergesort.md\":\"CxL__X6q\",\"algorithm_022-mergedivideandconquer.md\":\"Bh98NQsx\",\"algorithm_023-randomquicksort.md\":\"C0W1cDHV\",\"algorithm_024-randomizedselect.md\":\"DDuV2vSt\",\"algorithm_025-heapsort.md\":\"EDxxr299\",\"algorithm_026-usageofhashtableorderedtableandcomparator.md\":\"mA0vtjMc\",\"algorithm_027-commonquestionsaboutheapstructure.md\":\"DQTRi8OQ\",\"algorithm_028-radixsorting.md\":\"DgXlchJ5\",\"algorithm_029-summaryofimportantsortingalgorithms.md\":\"DtORkBev\",\"algorithm_030-funnyoperationofxoroperation.md\":\"DX5pQkRP\",\"algorithm_031-funnyoperationofbitoperation.md\":\"DnkH30Wg\",\"algorithm_032-bitmap.md\":\"Ct3UeKro\",\"algorithm_033-asmdbybitoperation.md\":\"BprUOZqV\",\"algorithm_034-essentialskillsoflinkedlist.md\":\"38ZshPMi\",\"algorithm_035-datastructuredesign.md\":\"Dzf8AhLK\",\"algorithm_036-binarytreespart1.md\":\"N2a7vr-_\",\"algorithm_037-binarytreespart2.md\":\"CeCnPxjI\",\"algorithm_038-analysisofcommonclassicrecursiveprocesses.md\":\"j-pgXN4x\",\"algorithm_039-recursiveproblemsolvingroutinesfornestedproblems.md\":\"C9q8qY7_\",\"algorithm_040-nqueenpproblem.md\":\"BpQqLPcB\",\"basic_collection_collectioninterviewquestions.md\":\"yzatNz-S\",\"basic_collection_collectionintro.md\":\"CVBgM2Ej\",\"basic_collection_collectionofarraylist.md\":\"C3IJckgb\",\"basic_collection_collectionofhashmap.md\":\"f6isJ3bN\",\"basic_collection_collectionofmap.md\":\"BTLkSS0_\",\"basic_java8newfeatures.md\":\"Mnx7thMe\",\"basic_javase_javaseinterviewquestions.md\":\"CYGR6AQz\",\"design-patterns_01-dp_01-introduction-to-design-patterns.md\":\"DBpA5TCc\",\"design-patterns_01-dp_02-creational-patterns.md\":\"jdy0Qc8L\",\"design-patterns_01-dp_03-structuralpatterns.md\":\"d3pdqvpV\",\"design-patterns_01-dp_04-behavioralpatterns.md\":\"9soy8c_w\",\"index.md\":\"BhlSE_SA\",\"interview_01-interview4.md\":\"VgqF7Hut\",\"interview_2408.md\":\"Cucv9hbC\",\"interview_hwod.md\":\"DlDtsIKz\",\"interview_untitled.md\":\"O1-fw9cy\",\"juc_01-completablefuture.md\":\"Cr8iU8ew\",\"juc_02-lock.md\":\"DwFAtMCD\",\"juc_03-locksupport.md\":\"Dq0MA74c\",\"juc_04-jmm.md\":\"d9fKDoRG\",\"juc_05-cas.md\":\"DtBJX1vQ\",\"juc_jucinterviewquestions.md\":\"DAAJTEVl\",\"jvm_01-bytecode.md\":\"s0Xc6P9l\",\"jvm_02-classloader.md\":\"CixF2vKk\",\"jvm_03-runtimememory.md\":\"JIBJIyBL\",\"jvm_04-objectmemorylayout.md\":\"itOsQVgh\",\"jvm_05-executionengine.md\":\"CEh1PQOb\",\"jvm_06-garbagecollection.md\":\"B9GD9qSC\",\"jvm_07-jvmperformancemonitoring.md\":\"DBW_NhQq\",\"jvm_08-jvmperformancetuningcase.md\":\"D6nGIekp\",\"mysql_mysqlinterviewquestions.md\":\"CIrgz2dz\",\"projects_tingshu_01-gettingstart.md\":\"DI8pnHpx\",\"projects_tingshu_02-albummanagement.md\":\"D7MEpRXI\",\"projects_tingshu_03-trackmanagement.md\":\"C3tYDYDz\",\"projects_tingshu_04-userlogin.md\":\"C3nML_7V\",\"projects_tingshu_05-albumsearch.md\":\"CDzxPzKH\",\"projects_tingshu_06-albumdetails.md\":\"DteHIcpL\",\"projects_tingshu_07-cacheconfig.md\":\"CVwsLKBo\",\"projects_tingshu_08-ordermanagement.md\":\"BwEJ-vhN\",\"projects_tingshu_09-accountmanagement.md\":\"DSad9wMN\",\"projects_tingshu_10-wxpayment.md\":\"DGiqeHIx\",\"projects_tingshu_11-scheduletask.md\":\"BRaqS3Rt\",\"projects_tingshu_12-rabbitmqjob.md\":\"BQ7RGYEb\",\"projects_tingshu_13-kafkajob.md\":\"4HMCW3J-\",\"projects_tingshu_20-orderprocess.md\":\"BsqTeo5l\",\"qingke-upload_01-gettingstart.md\":\"sDJLreaR\",\"rabbitmq_01-gettingstart.md\":\"Dr1feK-O\",\"redis_01-basicdatatypes.md\":\"Co2Zv_oJ\",\"redis_02-persistencesolution.md\":\"Dtz2HmH9\",\"redis_redisinterviewquestions.md\":\"Cjhl79kK\",\"spring_annotation_01-componentregist.md\":\"jaz2lyLe\",\"spring_annotation_02-beanlifecycle.md\":\"7zNzxN-Z\",\"spring_annotation_03-propertyandautowiring.md\":\"CxRMEcRw\",\"spring_annotation_04-aop.md\":\"CCwstJCX\",\"spring_annotation_05-multienvconfig.md\":\"DIoMarPU\",\"spring_annotation_10-@enableaspectjautoproxy.md\":\"DitL7HsL\",\"spring_annotation_11-annotationawareaspectjautoproxycreator.md\":\"DzTDHRpO\",\"spring_annotation_12-creataop.md\":\"BsiqeDpe\",\"spring_annotation_13-getinterceptchain.md\":\"D5qbqhhH\",\"spring_annotation_14-chainingnotificationmethods.md\":\"C47bprxX\",\"spring_annotation_15-summaryofaop.md\":\"DkEtsvwi\",\"spring_annotation_20-@enabletransactionmanagement.md\":\"DZBFRXD_\",\"spring_annotation_21-beanfactorypostprocessor.md\":\"DzKdDizT\",\"spring_annotation_22-beandefinitionregistrypostprocessor.md\":\"D0S5Iwp6\",\"spring_annotation_23-applicationlistener.md\":\"DBFvFf2m\",\"spring_annotation_24-@eventlistenerandsmartinitializingsingleton.md\":\"Bmws2kLA\",\"spring_springinterviewquestions.md\":\"XIn0AaPF\",\"tools_deployvitepress.md\":\"C85VINbC\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Java\",\"description\":\"A VitePress Site\",\"base\":\"/java/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\"},\"nav\":[{\"text\":\"Java基础\",\"items\":[{\"text\":\"JavaSE\",\"link\":\"/basic/collection/CollectionInterviewQuestions\"},{\"text\":\"JVM\",\"link\":\"/jvm/01-ByteCode\"}]},{\"text\":\"计算机基础\",\"items\":[{\"text\":\"数据结构与算法\",\"link\":\"/algorithm/001-GettingStart\"},{\"text\":\"设计模式\",\"link\":\"/design-patterns/01-dp/01-introduction-to-design-patterns\"}]},{\"text\":\"数据库\",\"items\":[{\"text\":\"MySQL\",\"link\":\"/mysql/MySQLInterviewQuestions\"},{\"text\":\"Redis\",\"link\":\"/redis/RedisInterviewQuestions\"}]},{\"text\":\"Spring\",\"items\":[{\"text\":\"Spring注解驱动开发\",\"link\":\"/spring/annotation/01-ComponentRegist\"}]},{\"text\":\"中间件\",\"items\":[{\"text\":\"RabbitMQ\",\"link\":\"/rabbitmq/01-GettingStart\"}]},{\"text\":\"并发编程\",\"items\":[{\"text\":\"JUC\",\"link\":\"/juc/JUCInterviewQuestions\"}]},{\"text\":\"项目实战\",\"items\":[{\"text\":\"听书项目(仿喜马拉雅)\",\"link\":\"/projects/tingshu/01-GettingStart\"}]}],\"sidebar\":{\"/basic/\":[{\"text\":\"集合\",\"items\":[{\"text\":\"Java集合概述\",\"link\":\"/basic/collection/CollectionIntro\"},{\"text\":\"Map接口继承树\",\"link\":\"/basic/collection/CollectionOfMap\"},{\"text\":\"深入Java集合系列之ArrayList\",\"link\":\"/basic/collection/CollectionOfArrayList\"},{\"text\":\"深入Java集合系列之HashMap\",\"link\":\"/basic/collection/CollectionOfHashMap\"},{\"text\":\"集合面试题\",\"link\":\"/basic/collection/CollectionInterviewQuestions\"},{\"text\":\"JavaSE面试题\",\"link\":\"/basic/javase/JavaSEInterviewQuestions\"}]},{\"text\":\"新特性\",\"items\":[{\"text\":\"Java8新特性\",\"link\":\"/basic/Java8NewFeatures\"}]}],\"/jvm/\":[{\"text\":\"JVM\",\"items\":[{\"text\":\"字节码\",\"link\":\"/jvm/01-ByteCode\"},{\"text\":\"类的加载器\",\"link\":\"/jvm/02-ClassLoader\"},{\"text\":\"运行时内存\",\"link\":\"/jvm/03-RuntimeMemory\"},{\"text\":\"对象内存布局\",\"link\":\"/jvm/04-ObjectMemoryLayout\"},{\"text\":\"执行引擎\",\"link\":\"/jvm/05-ExecutionEngine\"},{\"text\":\"垃圾回收器\",\"link\":\"/jvm/06-GarbageCollection\"},{\"text\":\"JVM性能监控\",\"link\":\"/jvm/07-JVMPerformanceMonitoring\"},{\"text\":\"JVM性能调优案例\",\"link\":\"/jvm/08-JVMPerformanceTuningCase\"}]}],\"/algorithm/\":[{\"text\":\"汇总\",\"items\":[{\"text\":\"算法模板\",\"link\":\"/algorithm/000-AlgorithmTemplates\"},{\"text\":\"题目链接\",\"link\":\"/algorithm/000-QuestionsLink\"}]},{\"text\":\"入门\",\"items\":[{\"text\":\"GettingStart\",\"link\":\"/algorithm/001-GettingStart\"},{\"text\":\"从社会实验到入门提醒\",\"link\":\"/algorithm/002-FromSocialExperimentToEntryReminder\"},{\"text\":\"二进制和位运算\",\"link\":\"/algorithm/003-BinaryAndBitwiseOperations\"},{\"text\":\"选择、冒泡、插入排序\",\"link\":\"/algorithm/004-SelectionBubbleInsertionSort\"},{\"text\":\"对数器-验证的重要手段\",\"link\":\"/algorithm/005-Logarithm\"},{\"text\":\"二分搜索\",\"link\":\"/algorithm/006-BinarySearch\"},{\"text\":\"时间复杂度和空间复杂度\",\"link\":\"/algorithm/007-TimeAndSpaceComplexity\"},{\"text\":\"算法和数据结构简介\",\"link\":\"/algorithm/008-IntroductionToAlgorithmsAndDataStructures\"},{\"text\":\"单链表及其反转——堆栈解释\",\"link\":\"/algorithm/009-SinglyLinkedListReversalAndStackExplained\"},{\"text\":\"合并两个有序链表\",\"link\":\"/algorithm/010-MergeTwoLists\"},{\"text\":\"两个链表相加\",\"link\":\"/algorithm/011-AddTwoNumbers\"},{\"text\":\"划分链表\",\"link\":\"/algorithm/012-PartitionList\"},{\"text\":\"队列和栈——链表和数组实现\",\"link\":\"/algorithm/013-QueueStackAndCircularQueue\"},{\"text\":\"栈和队列相互实现\",\"link\":\"/algorithm/014-ConvertQueueAndStack\"},{\"text\":\"最小栈\",\"link\":\"/algorithm/015-GetMinStack\"},{\"text\":\"双端队列——双链表和固定数组实现\",\"link\":\"/algorithm/016-CirCularDeque\"},{\"text\":\"二叉树及其三种序的递归实现\",\"link\":\"/algorithm/017-BinaryTreeTraversalRecursion\"},{\"text\":\"二叉树遍历的非递归实现及其复杂度分析\",\"link\":\"/algorithm/018-BinaryTreeTraversalIteration\"}]},{\"text\":\"必备\",\"items\":[{\"text\":\"算法笔试中处理输入和输出\",\"link\":\"/algorithm/019-ProcessingInputAndOutputInAlgorithm\"},{\"text\":\"递归和master公式\",\"link\":\"/algorithm/020-RecursionAndTheMasterFormula\"},{\"text\":\"归并排序\",\"link\":\"/algorithm/021-MergeSort\"},{\"text\":\"归并分治\",\"link\":\"/algorithm/022-MergeDivideAndConquer\"},{\"text\":\"随机快排\",\"link\":\"/algorithm/023-RandomQuickSort\"},{\"text\":\"随机选择算法\",\"link\":\"/algorithm/024-RandomizedSelect\"},{\"text\":\"堆结构和堆排序\",\"link\":\"/algorithm/025-HeapSort\"},{\"text\":\"哈希表、有序表和比较器的用法\",\"link\":\"/algorithm/026-UsageOfHashTableOrderedTableAndComparator\"},{\"text\":\"堆结构常见题\",\"link\":\"/algorithm/027-CommonQuestionsAboutHeapStructure\"}]}],\"/design-patterns/\":[{\"text\":\"总览设计模式\",\"items\":[{\"text\":\"设计模式导论\",\"link\":\"/design-patterns/01-dp/01-introduction-to-design-patterns\"},{\"text\":\"创建型模式\",\"link\":\"/design-patterns/01-dp/02-creational-patterns\"},{\"text\":\"结构型模式\",\"link\":\"/design-patterns/01-dp/03-StructuralPatterns\"},{\"text\":\"行为型模式\",\"link\":\"/design-patterns/01-dp/04-BehavioralPatterns\"}]}],\"/mysql/\":[{\"text\":\"MySQL\",\"items\":[{\"text\":\"MySQL面试题\",\"link\":\"/mysql/MySQLInterviewQuestions\"}]}],\"/redis/\":[{\"text\":\"Redis\",\"items\":[{\"text\":\"Redis面试题\",\"link\":\"/redis/RedisInterviewQuestions\"}]}],\"/spring/annotation/\":[{\"text\":\"注解开发\",\"items\":[{\"text\":\"组件注册\",\"link\":\"/spring/annotation/01-ComponentRegist\"},{\"text\":\"Bean生命周期\",\"link\":\"/spring/annotation/02-BeanLifeCycle\"},{\"text\":\"属性赋值&自动装配\",\"link\":\"/spring/annotation/03-PropertyAndAutowiring\"},{\"text\":\"AOP\",\"link\":\"/spring/annotation/04-AOP\"},{\"text\":\"多环境配置\",\"link\":\"/spring/annotation/05-MultiEnvConfig\"}]},{\"text\":\"AOP源码分析\",\"items\":[{\"text\":\"@EnableAspectJAutoProxy\",\"link\":\"/spring/annotation/10-@EnableAspectJAutoProxy\"},{\"text\":\"AnnotationAwareAspectJAutoProxyCreator\",\"link\":\"/spring/annotation/11-AnnotationAwareAspectJAutoProxyCreator\"},{\"text\":\"创建AOP代理\",\"link\":\"/spring/annotation/12-CreatAOP\"},{\"text\":\"获取拦截器链\",\"link\":\"/spring/annotation/13-GetInterceptChain\"},{\"text\":\"链式调用通知方法\",\"link\":\"/spring/annotation/14-ChainingNotificationMethods\"},{\"text\":\"AOP原理总结\",\"link\":\"/spring/annotation/15-SummaryOfAOP\"}]},{\"text\":\"扩展原理\",\"items\":[{\"text\":\"声明式事务\",\"link\":\"/spring/annotation/20-@EnableTransactionManagement\"},{\"text\":\"BeanFactoryPostProcessor\",\"link\":\"/spring/annotation/21-BeanFactoryPostProcessor\"},{\"text\":\"BeanDefinitionRegistryPostProcessor\",\"link\":\"/spring/annotation/22-BeanDefinitionRegistryPostProcessor\"},{\"text\":\"ApplicationListener用法&原理\",\"link\":\"/spring/annotation/23-ApplicationListener\"},{\"text\":\"@EventListener&SmartInitializingSingleton\",\"link\":\"/spring/annotation/24-@EventListenerAndSmartInitializingSingleton\"}]}],\"/rabbitmq/\":[{\"text\":\"RabbitMQ\",\"items\":[{\"text\":\"RabbitMQ\",\"link\":\"/rabbitmq/01-GettingStart\"}]}],\"/juc/\":[{\"text\":\"并发编程\",\"items\":[{\"text\":\"JUC面试题\",\"link\":\"/juc/JUCInterviewQuestions\"},{\"text\":\"多线程锁\",\"link\":\"/juc/02-Lock\"}]}],\"/projects/tingshu/\":[{\"text\":\"听书项目\",\"items\":[{\"text\":\"准备工作\",\"link\":\"/projects/tingshu/01-GettingStart\"},{\"text\":\"专辑管理\",\"link\":\"/projects/tingshu/02-AlbumManagement\"},{\"text\":\"声音管理\",\"link\":\"/projects/tingshu/03-TrackManagement\"},{\"text\":\"用户登录\",\"link\":\"/projects/tingshu/04-UserLogin\"},{\"text\":\"专辑搜索\",\"link\":\"/projects/tingshu/05-AlbumSearch\"},{\"text\":\"专辑详情\",\"link\":\"/projects/tingshu/06-AlbumDetails\"},{\"text\":\"缓存切面\",\"link\":\"/projects/tingshu/07-CacheConfig\"},{\"text\":\"订单管理\",\"link\":\"/projects/tingshu/08-OrderManagement\"},{\"text\":\"账户管理\",\"link\":\"/projects/tingshu/09-AccountManagement\"},{\"text\":\"微信支付\",\"link\":\"/projects/tingshu/10-WxPayment\"},{\"text\":\"定时任务\",\"link\":\"/projects/tingshu/11-ScheduleTask\"},{\"text\":\"RabbitMQ\",\"link\":\"/projects/tingshu/12-RabbitMQJob\"},{\"text\":\"kafka\",\"link\":\"/projects/tingshu/13-KafkaJob\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/pengbin2367/java\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>